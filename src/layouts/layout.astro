---
import Header from '../components/header.astro';
import Footer from '../components/footer.astro';

export interface Props {
  title?: string;
  description?: string;
  lang?: 'sr' | 'en';
  canonicalURL?: string;
  ogImage?: string;
  isErrorPage?: boolean;
}

const {
  title: propTitle,
  description,
  lang = 'sr',
  canonicalURL,
  ogImage,
  isErrorPage = false,
} = Astro.props;

const siteData = {
  sr: {
    title: 'Menjačnica Genes Novi Sad',
    description:
      'Menjačnica Genes Novi Sad je Vaša pouzdana menjačnica za razmenu valuta, uplatu računa, osiguranja, komunalija. Sigurno, brzo i jednostavno. Već više od 10 godina sa Vama. Posetite nas na adresi Hajduk Veljkova 11, Novi Sad na novosadskom sajmu.',
  },
  en: {
    title: 'Genes Exchange Office Novi Sad',
    description:
      'Genes Exchange Office Novi Sad is your trusted exchange office for currency exchange, bill payments, insurance, and utilities. Safe, fast, and simple. Over 10 years with you. Visit us at Hajduk Veljkova 11, Novi Sad at the Novi Sad Fair.',
  },
};

const title = propTitle || siteData[lang].title;
const finalDescription = description || siteData[lang].description;

const baseURL = 'https://menjacnicagenes.rs';
const currentCanonicalURL = canonicalURL || new URL(Astro.url.pathname, baseURL).href;

const currentPath = Astro.url.pathname;
const srURL = currentPath.startsWith('/en/')
  ? new URL(currentPath.replace('/en/', '/'), baseURL).href
  : new URL(currentPath, baseURL).href;

const hasEnglishVersion =
  currentPath === '/' || currentPath === '/kursna-lista' || currentPath.startsWith('/en/');
const enURL = currentPath.startsWith('/en/')
  ? new URL(currentPath, baseURL).href
  : hasEnglishVersion && currentPath === '/'
    ? new URL('/en/', baseURL).href
    : hasEnglishVersion && currentPath === '/kursna-lista'
      ? new URL('/en/exchange-rates', baseURL).href
      : null;

const defaultOgImage = `${baseURL}/images/GenesLogoMeta.webp`;
const ogImageURL = ogImage ? `${baseURL}${ogImage}` : defaultOgImage;

const keywords = {
  sr: 'menjačnica, menjacnica genes, genes exchange, menjačnica novi sad, kursna lista, kurs evra, kurs dolara, zamena valute, razmena valute, devizna menjačnica, otkup valute, prodaja valute, eur rsd, usd rsd, chf rsd, gbp rsd, povoljni kursevi, najpovoljnija menjačnica, platni promet, payspot, uplata računa, menjačnica srbija, exchange office novi sad, novosadski sajam, sajam, sajmiste, komunalije',
  en: 'exchange office, currency exchange, genes exchange, novi sad, exchange rates, euro rate, dollar rate, currency conversion, buy currency, sell currency, eur rsd, usd rsd, chf rsd, gbp rsd, favorable rates, payment transfer, payspot, bill payment, serbia, novosadski sajam, exchange',
};
---

<!doctype html>
<html lang={lang}>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <meta name="description" content={finalDescription} />
    <meta name="keywords" content={keywords[lang]} />
    <meta name="generator" content={Astro.generator} />
    <meta
      name="robots"
      content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1"
    />
    <meta name="googlebot" content="index, follow" />
    <meta name="bingbot" content="index, follow" />

    <link rel="dns-prefetch" href="https://www.googletagmanager.com" />
    <link rel="preconnect" href="https://www.googletagmanager.com" crossorigin />

    <link rel="apple-touch-icon-precomposed" href="/favicons/apple-icon-precomposed.png" />
    <link rel="apple-touch-icon" href="/favicons/apple-icon.png" />
    <link rel="apple-touch-icon" sizes="57x57" href="/favicons/apple-icon-57x57.png" />
    <link rel="apple-touch-icon" sizes="60x60" href="/favicons/apple-icon-60x60.png" />
    <link rel="apple-touch-icon" sizes="72x72" href="/favicons/apple-icon-72x72.png" />
    <link rel="apple-touch-icon" sizes="76x76" href="/favicons/apple-icon-76x76.png" />
    <link rel="apple-touch-icon" sizes="114x114" href="/favicons/apple-icon-114x114.png" />
    <link rel="apple-touch-icon" sizes="120x120" href="/favicons/apple-icon-120x120.png" />
    <link rel="apple-touch-icon" sizes="144x144" href="/favicons/apple-icon-144x144.png" />
    <link rel="apple-touch-icon" sizes="152x152" href="/favicons/apple-icon-152x152.png" />
    <link rel="apple-touch-icon" sizes="180x180" href="/favicons/apple-icon-180x180.png" />
    <link rel="icon" type="image/png" sizes="192x192" href="/favicons/android-icon-192x192.png" />
    <link rel="icon" type="image/png" sizes="144x144" href="/favicons/android-icon-144x144.png" />
    <link rel="icon" type="image/png" sizes="96x96" href="/favicons/android-icon-96x96.png" />
    <link rel="icon" type="image/png" sizes="72x72" href="/favicons/android-icon-72x72.png" />
    <link rel="icon" type="image/png" sizes="48x48" href="/favicons/android-icon-48x48.png" />
    <link rel="icon" type="image/png" sizes="36x36" href="/favicons/android-icon-36x36.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicons/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="/favicons/favicon-16x16.png" />
    <link rel="manifest" href="/favicons/manifest.json" />
    <meta name="msapplication-TileColor" content="#ffffff" />
    <meta name="msapplication-TileImage" content="/favicons/ms-icon-144x144.png" />
    <meta name="msapplication-TileImage" content="/favicons/ms-icon-310x310.png" />
    <meta name="msapplication-square70x70logo" content="/favicons/ms-icon-70x70.png" />
    <meta name="msapplication-square150x150logo" content="/favicons/ms-icon-150x150.png" />
    <meta name="theme-color" content="#0b0b0b" />
    <link rel="icon" type="image/x-icon" href="/favicon.ico" />

    <link rel="canonical" href={currentCanonicalURL} />
    <link rel="alternate" hreflang="sr" href={srURL} />
    {enURL && <link rel="alternate" hreflang="en" href={enURL} />}
    <link rel="alternate" hreflang="x-default" href={srURL} />

    <meta property="og:url" content={currentCanonicalURL} />
    <meta property="og:image" content={ogImageURL} />
    <meta property="og:image:type" content="image/webp" />
    <meta property="og:image:width" content="1920" />
    <meta property="og:image:height" content="1080" />
    <meta property="og:image:alt" content={title} />
    <meta property="og:type" content="website" />
    <meta property="og:title" content={title} />
    <meta property="og:description" content={finalDescription} />
    <meta property="og:site_name" content={lang === 'sr' ? 'Menjačnica Genes' : 'Genes Exchange'} />
    <meta property="og:locale" content={lang === 'sr' ? 'sr_RS' : 'en_US'} />

    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content={title} />
    <meta name="twitter:description" content={finalDescription} />
    <meta name="twitter:image" content={ogImageURL} />
    <meta name="twitter:image:alt" content={title} />

    <meta name="author" content={lang === 'sr' ? 'Menjačnica Genes' : 'Genes Exchange'} />

    <title>{title}</title>

    <slot name="head" />

    <style is:global>
      @import '../scss/main.scss';
    </style>

    <script
      type="text/partytown"
      async
      src="https://www.googletagmanager.com/gtag/js?id=G-9N2QRN6XCT"></script>
    <script type="text/partytown">
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag('js', new Date());
      gtag('config', 'G-9N2QRN6XCT');
    </script>
  </head>
  <body class={isErrorPage ? 'error-page-body' : ''}>
    <Header lang={lang} />

    <slot />

    <Footer lang={lang} />

    <script>
      import '../main.ts';
    </script>
  </body>
</html>
